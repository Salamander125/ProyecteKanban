<Window x:Class="KANBAN_INTERFICIE.PissarraKanban_MainWindow" 
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
        Title="Kanban Board" 
        Height="600" Width="900" 
        WindowStartupLocation="CenterScreen" >
    
    <!-- STYLE PER SIMULAR QUE EL BORDER ÉS UN BUTTON -->
    <Window.Resources>
        <Style x:Key="KanbanCardStyle" TargetType="Border">
            <!-- Aparença base -->
            <Setter Property="CornerRadius" Value="10"/>
            <Setter Property="Padding" Value="8"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#66000000"/>
            <Setter Property="Cursor" Value="Hand"/>
            <!-- IMPORTANT: permet focus -->
            <Setter Property="Focusable" Value="True"/>
            <Style.Triggers>
                <!-- Hover -->
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Effect">
                        <Setter.Value>
                            <DropShadowEffect BlurRadius="8" ShadowDepth="2" Opacity="0.35"/>
                        </Setter.Value>
                    </Setter>
                </Trigger>
                <!-- Pressed (Mouse Down) -->
                <Trigger Property="IsMouseCaptured" Value="True">
                    <Setter Property="RenderTransform">
                        <Setter.Value>
                            <TranslateTransform X="1" Y="1"/>
                        </Setter.Value>
                    </Setter>
                    <Setter Property="Opacity" Value="0.85"/>
                </Trigger>
                <!-- Focus (teclat) -->
                <Trigger Property="IsFocused" Value="True">
                    <Setter Property="BorderBrush" Value="DodgerBlue"/>
                    <Setter Property="BorderThickness" Value="2"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        
        <!-- DATA TEMPLATE TIQUETS -->
        <DataTemplate x:Key="KanbanCardTemplate">
            <Border CornerRadius="10" Padding="8" Margin="5" Background="{Binding ColorPrioritat}" BorderBrush="#66000000" BorderThickness="1" Style="{StaticResource KanbanCardStyle}" PreviewMouseLeftButtonDown="Card_PreviewMouseLeftButtonDown" MouseMove="Card_MouseMove" MouseLeftButtonUp="Card_MouseLeftButtonUp">
                <StackPanel>
                    <TextBlock FontWeight="Bold" Text="{Binding Titol}"/>         <!--TITOL TIQUET-->
                    <TextBlock Text="{Binding Description}" TextWrapping="Wrap"/> <!--DESCRIPCIO TIQUET-->
                    <TextBlock Text="{Binding Codi_id}" FontFamily="Cascadia Code Light" FontSize="10"/>
                </StackPanel>
            </Border>
        </DataTemplate>
    </Window.Resources>
    
    
    <Grid Margin="10">
        <!-- Dos files: - Superior: columnes del kanban - Inferior: Actual zona de gestió -->
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="180"/>
        </Grid.RowDefinitions>
        <!-- Tres columnes per a les tres llistes: To Do – En Progrés – Acabat -->
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        
        <!-- SEPARADOR DE COLUMNES-->
        <GridSplitter HorizontalAlignment="Left" Height="385" VerticalAlignment="Top" Width="0" Background="#7FBDBDBD" Grid.Column="1" Grid.ColumnSpan="1"/>
        <GridSplitter HorizontalAlignment="Left" Height="385" VerticalAlignment="Top" Width="0" Background="#7FBDBDBD" Grid.Column="2" Grid.ColumnSpan="1"/>
        
        <!-- =========================
        === LLISTA "TO DO" ====
        ======================== -->
        <StackPanel Grid.Column="0" Margin="5">
            <!-- Titol de la columna-->
            <TextBlock Text="To Do" FontSize="18" FontWeight="Bold" HorizontalAlignment="Center" Margin="0 0 0 10" FontFamily="Segoe UI Variable Small Semibold" TextDecorations="Underline" />
            
            <!-- Llistat de tasques (ListView) -->
            <ListView ItemTemplate="{StaticResource KanbanCardTemplate}" 
                      Name="LlistaToDo" 
                      ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                      DragOver="ListView_DragOver" 
                      Drop="HandleDrop" 
                      AllowDrop="True" 
                      MinHeight="280" >
                <!-- Les targetes es col·loquen dins un WrapPanel -->
                <ListView.ItemsPanel>
                    <ItemsPanelTemplate>
                        <WrapPanel />
                    </ItemsPanelTemplate>
                </ListView.ItemsPanel>
                
                <!-- Plantilla de Disseny visual de cada targeta -->
            </ListView>
        </StackPanel>
        
        <!-- LLISTA "EN PROGRES"-->
        <StackPanel Grid.Column="1" Margin="5">
            <TextBlock Text="En progrés" FontSize="18" FontWeight="Bold" HorizontalAlignment="Center" Margin="0 0 0 10" FontFamily="Segoe UI Variable Small Semibold" TextDecorations="Underline"/>
            <ListView ItemTemplate="{StaticResource KanbanCardTemplate}" 
                      Name="InProgressItems" 
                      ScrollViewer.HorizontalScrollBarVisibility="Disabled" 
                      DragOver="ListView_DragOver" 
                      Drop="HandleDrop" 
                      AllowDrop="True" 
                      MinHeight="280" >
                <ListView.ItemsPanel>
                    <ItemsPanelTemplate>
                        <WrapPanel />
                    </ItemsPanelTemplate>
                </ListView.ItemsPanel>
            </ListView>
        </StackPanel>
        
        <!-- LLISTA "ACABAT"-->
        <StackPanel Grid.Column="2" Margin="5">
            <TextBlock Text="Acabat" FontSize="18" FontWeight="Bold" HorizontalAlignment="Center" Margin="0 0 0 10" FontFamily="Segoe UI Variable Small Semibold" TextDecorations="Underline"/>
            <ListView ItemTemplate="{StaticResource KanbanCardTemplate}" 
                      Name="DoneItems"
                      ScrollViewer.HorizontalScrollBarVisibility="Disabled" 
                      DragOver="ListView_DragOver" 
                      Drop="HandleDrop" 
                      AllowDrop="True" 
                      MinHeight="280" >
                <ListView.ItemsPanel>
                    <ItemsPanelTemplate>
                        <WrapPanel />
                    </ItemsPanelTemplate>
                </ListView.ItemsPanel>
            </ListView>
        </StackPanel>
        
        
        <!--PART INFERIOR-->
        <Border Grid.Row="1" Grid.ColumnSpan="3" Background="#546666BF" Padding="10" CornerRadius="10,10,10,10" Margin="5">
            <StackPanel>
                <TextBlock Text="Gestió de targetes kanban" FontSize="16" FontWeight="Bold" Margin="0 0 0 10" FontFamily="Bahnschrift SemiBold"/>
                <Grid Height="98">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <!-- Description -->
                    <StackPanel Grid.Column="0">
                        <TextBlock Text="Descripció" />
                        <TextBox Name="DescriptionBox" Height="70" TextWrapping="Wrap"/>
                    </StackPanel>
                    <!-- Priority -->
                    <StackPanel Grid.Column="1" Margin="10 0 0 0">
                        <TextBlock Text="Prioritat"/>
                        <ComboBox Name="PriorityBox">
                            <ComboBoxItem Content="Baixa"/>
                            <ComboBoxItem Content="Mitjana"/>
                            <ComboBoxItem Content="Alta"/>
                        </ComboBox>
                        <Label Content="▲: Alta prioritat" Height="26" Margin="0,-3,0,0"/>
                        <Label Content="▮: Mitjana prioritat" Height="26" Margin="0,-10,0,0"/>
                        <Label Content=" ●: Baixa prioritat" Height="26" Margin="0,-10,0,0"/>
                    </StackPanel>
                    <!-- Status -->
                    <StackPanel Grid.Column="2" Margin="10 0 0 0">
                        <TextBlock Text="Status"/>
                        <ComboBox Name="StatusBox">
                            <ComboBoxItem Content="To Do"/>
                            <ComboBoxItem Content="In Progress"/>
                            <ComboBoxItem Content="Done"/>
                        </ComboBox>
                    </StackPanel>
                    <!-- Buttons -->
                    <StackPanel Grid.Column="3" Margin="0,0,0,0">
                        <Button Content="Afegir tasca" Margin="0,0,0,0" HorizontalAlignment="Center" Height="42" Width="125" FontFamily="MADE TOMMY" Click="AfegirTascaButton_Click" IsDefault="True"/>
                        <Button Name="GestioResponsablesButton" Content="Gestio de&#xD;&#xA;Responsables" Margin="0 5 0 0" HorizontalAlignment="Center" Height="49" Width="126" FontFamily="MADE TOMMY" Click="GestioResponsablesButton_Click" />
                    </StackPanel>
                </Grid>
            </StackPanel>
        </Border>
    </Grid>
</Window>